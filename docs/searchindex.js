Search.setIndex({docnames:["Distillation/callbacks","Distillation/data","Distillation/distillation","Distillation/loss_functions","Distillation/runners","Examples/classification_huggingface_transformers","Models/cv","Pruning/pruning","Pruning/runners","Quantization/quantization","examples","index","models","runners"],envversion:{"sphinx.domains.c":2,"sphinx.domains.changeset":1,"sphinx.domains.citation":1,"sphinx.domains.cpp":3,"sphinx.domains.index":1,"sphinx.domains.javascript":2,"sphinx.domains.math":2,"sphinx.domains.python":2,"sphinx.domains.rst":2,"sphinx.domains.std":2,sphinx:56},filenames:["Distillation/callbacks.rst","Distillation/data.rst","Distillation/distillation.rst","Distillation/loss_functions.rst","Distillation/runners.rst","Examples/classification_huggingface_transformers.rst","Models/cv.rst","Pruning/pruning.rst","Pruning/runners.rst","Quantization/quantization.rst","examples.rst","index.rst","models.rst","runners.rst"],objects:{"compressors.distillation":{losses:[3,1,0,"-"],runners:[4,1,0,"-"]},"compressors.distillation.callbacks":{AttentionHiddenStatesCallback:[2,0,1,""],KLDivCallback:[2,0,1,""],MSEHiddenStatesCallback:[2,0,1,""],hidden_states:[0,1,0,"-"],logits_diff:[0,1,0,"-"],wrappers:[0,1,0,"-"]},"compressors.distillation.callbacks.hidden_states":{AttentionHiddenStatesCallback:[0,0,1,""],CosineHiddenStatesCallback:[0,0,1,""],HiddenStatesSelectCallback:[0,0,1,""],LambdaSelectCallback:[0,0,1,""],MSEHiddenStatesCallback:[0,0,1,""],PKTHiddenStatesCallback:[0,0,1,""]},"compressors.distillation.callbacks.logits_diff":{KLDivCallback:[0,0,1,""]},"compressors.distillation.callbacks.wrappers":{LambdaWrp:[0,0,1,""]},"compressors.distillation.data":{LogitsDataset:[1,0,1,""],label_smoothing:[1,1,0,"-"]},"compressors.distillation.data.label_smoothing":{probability_shift:[1,2,1,""]},"compressors.distillation.losses":{AttentionLoss:[3,0,1,""],CRDLoss:[3,0,1,""],KLDivLoss:[3,0,1,""],MSEHiddenStatesLoss:[3,0,1,""],kl_div_loss:[3,2,1,""],mse_loss:[3,2,1,""],pkt_loss:[3,2,1,""]},"compressors.distillation.losses.AttentionLoss":{forward:[3,3,1,""]},"compressors.distillation.losses.CRDLoss":{forward:[3,3,1,""]},"compressors.distillation.losses.KLDivLoss":{forward:[3,3,1,""]},"compressors.distillation.losses.MSEHiddenStatesLoss":{forward:[3,3,1,""]},"compressors.distillation.losses._kl_loss":{KLDivLoss:[2,0,1,""]},"compressors.distillation.runners":{DistilRunner:[4,0,1,""],EndToEndDistilRunner:[4,0,1,""],HFDistilRunner:[4,0,1,""]},"compressors.distillation.runners.EndToEndDistilRunner":{get_callbacks:[4,3,1,""],get_stage_len:[4,3,1,""],predict_batch:[4,3,1,""],stages:[4,3,1,""]},"compressors.models":{base_distil_model:[12,1,0,"-"],cv:[6,1,0,"-"]},"compressors.models.base_distil_model":{BaseDistilModel:[12,0,1,""]},"compressors.models.base_distil_model.BaseDistilModel":{forward:[12,3,1,""]},"compressors.models.cv":{resnet101:[6,2,1,""],resnet152:[6,2,1,""],resnet18:[6,2,1,""],resnet34:[6,2,1,""],resnet50:[6,2,1,""],resnet_cifar_110:[6,2,1,""],resnet_cifar_14:[6,2,1,""],resnet_cifar_20:[6,2,1,""],resnet_cifar_32:[6,2,1,""],resnet_cifar_32x4:[6,2,1,""],resnet_cifar_44:[6,2,1,""],resnet_cifar_56:[6,2,1,""],resnet_cifar_8:[6,2,1,""],resnet_cifar_8x4:[6,2,1,""],resnext101_32x8d:[6,2,1,""],resnext50_32x4d:[6,2,1,""],wide_resnet101_2:[6,2,1,""],wide_resnet50_2:[6,2,1,""]},"compressors.pruning":{callbacks:[7,1,0,"-"],runners:[7,1,0,"-"],utils:[7,1,0,"-"]},"compressors.runners":{HFRunner:[13,0,1,""]},"compressors.runners.HFRunner":{handle_batch:[13,3,1,""]},compressors:{runners:[13,1,0,"-"]}},objnames:{"0":["py","class","Python class"],"1":["py","module","Python module"],"2":["py","function","Python function"],"3":["py","method","Python method"]},objtypes:{"0":"py:class","1":"py:module","2":"py:function","3":"py:method"},terms:{"07471":1,"101":6,"1024":6,"10837":0,"110":6,"128":[3,5,10],"128_a":5,"152":6,"16384":3,"1803":0,"1911":1,"1x1":6,"2048":6,"2_h":5,"32x4":6,"32x4d":6,"32x8d":6,"4_h":5,"512":[5,6],"512_a":5,"8x4":6,"case":10,"class":[0,1,2,3,4,10,12,13],"default":[0,2,3,4,12],"final":[4,10],"float":[0,2,3],"function":[0,1,2,11],"import":[5,10],"int":[0,2,3,4,10],"return":[1,3,4,5,6,10,12],"true":[0,1,2,4,5,6,10,12],"while":3,But:[2,10],For:[1,2],The:[2,3,6,10],There:11,Used:13,Useful:0,__init__:10,_kl_loss:2,abs:[0,1],accumul:10,accuraci:5,accuracy01:10,accuracycallback:10,adam:[5,10],add:[2,10,12],add_batch:5,addit:[4,10],afterward:3,ag_new:5,aggreg:6,aka:[0,2],all:[3,10],also:[2,10],although:3,analog:0,anchor:3,ani:[4,6,13],api:11,append:10,appli:[0,2],apply_probability_shift:4,approach:2,arg:[4,10,12,13],argmax:[1,5],arrai:4,arxiv:[0,1],attent:[0,2],attention_loss:[0,2],attention_mask:5,attentionhiddenstatescallback:[0,2],attentionloss:[2,3],automodelforsequenceclassif:5,autonotebook:5,autotoken:5,backward:5,bar:6,base:[0,1,12],base_callback:0,base_distil_model:12,basedistilmodel:[10,12],batch:[0,1,4,5,13],batch_siz:[1,3,5,10],begin:10,bert_uncased_l:5,best_accuraci:5,best_stud:5,better:[1,2],between:[0,2,3,4,10],big:2,block:6,bool:[0,1,2,3,4,6,10,12],bottleneck:6,buffer:3,call:[2,3],callabl:[0,1,4],callback:[2,4,10,11],can:[2,4,10,11],care:3,catalyst:[0,2,4,10,11],cdot:10,chain:10,channel:6,choos:3,cifar:6,classic:2,classif:[0,2],code:10,column:5,common:2,complex:[2,11],compress:11,compressor:[0,1,2,3,4,5,6,10,12,13],comput:[3,5,11,12],content:11,contrast:3,contrast_idx:3,contrib:10,convolut:6,core:[0,4],correct:1,cosin:[0,3],cosine_loss:0,cosinehiddenstatescallback:0,count:10,cpu:5,crd:3,crdloss:3,creat:10,criterion:10,criterioncallback:10,crossentropyloss:10,cuda:5,cur_hidden:10,data:[2,4,5,10,13],data_loader_kwarg:1,dataload:[1,4,5,10,13],dataset:[1,3,5,10],deep:6,def:[5,10],defin:[3,10],detach:5,deverg:3,devic:5,dict:[0,4,10,12],dict_to_devic:5,dictionari:[4,13],differ:[2,10],dimens:3,displai:6,distil:[0,1,3,4,5,10,11,12],distilrunn:[2,4,10],distribut:[0,2,3,10],diverg:[2,3,10],dl_kei:10,doesn:[0,2],don:0,download:[6,10],dure:13,each:3,either:11,elif:10,els:[5,10,12],embed:3,end:4,endtoenddistilrunn:[4,10],enumer:10,epoch:[4,5],eps:3,eval:5,everi:[3,6],exampl:[2,11],examplemodel:10,exapml:1,except:6,exclude_first_and_last:[0,2],experi:[2,4,13],f_s:3,f_t:3,fals:[0,2,3,4,5,6,10,12],feat_dim:3,featur:3,feature_dim:3,filter:0,final_loss:5,first:[0,2,10],flag:1,floattensor:3,forc:2,former:3,forward:[3,10,12],frac:2,from:[1,4,5,6,10,13],from_pretrain:5,get:1,get_callback:4,get_logits_fn:1,get_stage_len:4,given:4,googl:5,handl:13,handle_batch:13,has:[6,10],have:2,here:[2,10],hfdistilrunn:4,hfrunner:13,hidden:[2,3,4,10,12],hidden_dim:10,hidden_st:[0,5,10],hidden_state_loss:[4,5,10],hiddens_criterion:5,hiddens_kei:0,hiddens_loss:5,hiddenstatesselectcallback:[0,10],hint:[0,2],hook:3,http:[0,1],huggingfac:[10,13],idea:11,idx:3,ignor:3,imag:[2,6],imagenet:6,implement:[2,4],improv:1,includ:3,indic:3,infer:[4,13],initi:10,inner:13,inp:10,inplac:0,input:0,input_id:5,input_kei:10,instanc:3,instead:3,is_avail:5,item:[5,10],iten:5,itertool:10,join:5,just:[2,4,10,11],kei:[0,5],kernel:3,keys_to_appli:0,kl_callback:10,kl_div_loss:[0,2,3,5],kl_loss:[4,10],kldivcallback:[0,2,10],kldivloss:[2,3,5,10],knoweledg:[2,12],knowledg:[1,2,4],knowlewdg:0,kwarg:[1,4,6,12,13],l_2:2,label:[1,5],label_smooth:1,lambda:[0,5],lambda_fn:0,lambdaselectcallback:0,lambdawrp:0,larger:6,last:[0,2,4,6,10],last_onli:0,latter:3,layer:[0,10],layer_idx:10,learn:[6,10],leav:5,left:2,length:4,lesson:1,let:[2,10],librari:11,like:2,linear:10,list:0,load:5,load_dataset:5,load_metr:5,load_state_dict:5,loader:[5,10],loader_kei:5,log:[2,10],log_str:5,logdir:10,logit:[1,2,4,5,10],logits_criterion:5,logits_diff:0,logits_diff_loss:4,logits_loss:5,logitsdataset:1,look:2,loss:[0,2,4,5,10],loss_weight:4,main:[10,11],make:13,mani:11,map:[4,5,12,13],mapping_optim:5,max_length:5,measur:2,memori:3,merg:1,merge_logits_with_batch_fn:1,met:5,method:[2,12,13],metric:5,metric_fn:5,metricaggregationcallback:10,minim:11,minimize_valid_metr:10,mlp:10,mnist:10,model:[0,1,2,3,4,6,10,11],modifi:0,modul:[1,3],modulelist:10,momentum:3,more:[2,10],most:2,mse:[0,2,3,10],mse_callback:10,mse_hiddens_loss:5,mse_loss:[0,2,3,10],msehiddenstatescallback:[0,2,10],msehiddenstatesloss:[2,3,5],mseloss:10,n_data:3,name:[0,2,4],nce_k:3,nce_m:3,nce_t:3,need:[2,3,10],need_map:[0,2,3,5],neg:3,network:[2,3,6],neural:[2,6],nlp:11,no_grad:5,none:[0,1,2,3,4],norm:2,normal:[0,2,3,5],notimplementederror:4,now:10,num_epoch:[5,10],num_label:5,num_lay:[0,2,3,5,10],num_train_teacher_epoch:[4,10],number:[3,4,6],numpi:5,one:[2,3,4],onli:[0,2,10],opt:3,optim:[5,10],optimi:10,option:[0,1,2,3,4,12],ordereddict:4,ordinari:10,org:[0,1],other:2,our:10,outer:6,output:[0,3,4,10,12],output_hidden_st:[4,5,10,12],output_kei:[0,2],over:[0,3],overridden:3,p_1:2,p_2:2,pad:5,pair:3,paper:2,param:6,paramet:[0,1,2,3,4,5,10,12,13],part:[3,11],pass:[3,4],pbar_epoch:5,pbar_load:5,perform:[2,3],philosophi:11,pipelin:10,pkt:0,pkt_loss:[0,3],pkthiddenstatescallback:0,posit:3,pre:6,predict:5,predict_batch:4,prepar:1,preprocess:10,pretrain:6,print:5,probabilist:0,probability_shift:1,probabl:[0,2,10],produc:2,progress:6,project:3,properti:4,propos:[0,2],provid:[4,10,11],prune:11,pth:5,pytorch:10,quantiz:11,rais:[0,4],rang:10,readi:10,recip:3,recognit:6,refer:5,regist:3,relu:10,residu:6,resnet101:6,resnet152:6,resnet18:6,resnet34:6,resnet50:6,resnet:6,resnet_cifar:6,resnet_cifar_110:6,resnet_cifar_14:6,resnet_cifar_20:6,resnet_cifar_32:6,resnet_cifar_32x4:6,resnet_cifar_44:6,resnet_cifar_56:6,resnet_cifar_8:6,resnet_cifar_8x4:6,resnetcifar:6,resnext101_32x8d:6,resnext50_32x4d:6,resnext:6,retrun_dict:5,return_dict:[10,12],right:2,run:[3,4,10,12,13],runner:[0,2,10,11],runner_arg:4,runner_kwarg:4,s_dim:3,s_h:5,s_hidden:5,s_hidden_st:[0,3],s_logit:[0,2,3,10],same:[2,6],sampl:3,save:5,select_last_hidden_st:10,self:10,separ:11,set:[0,2,3,4,10],set_descript:5,set_format:5,sever:10,shape:2,should:[3,10],show:2,shuffl:[5,10],side:3,silent:3,similar:3,simpl:[2,4,10],simpli:10,sinc:3,size:3,slow:2,small:3,smaller:2,smooth:1,someth:[0,2],space:3,specifi:[0,4,13],stage:[4,13],startswith:5,state:[2,3,4,10,12],state_dict:5,stderr:6,step:5,str:[0,2,4,13],student:[0,2,3,5,10],student_dim:3,student_hidden_state_dim:[0,2,3,5],student_logits_kei:[0,2],student_model:5,student_output:5,subclass:3,submodul:11,sum:[4,10],sum_x:2,supervis:[1,10,13],supervisedrunn:10,support:10,swap:1,symmetr:3,t_dim:3,t_h:5,t_hidden:5,t_hidden_st:[0,3],t_logit:[0,2,3],take:[0,1,2,3],target:10,target_kei:10,task:[0,2,10,11,13],task_loss:5,teacher:[0,1,2,3,4,5,10],teacher_dim:3,teacher_hidden_state_dim:[0,2,3,5],teacher_logits_kei:[0,2],teacher_model:5,teacher_output:5,temperatur:[0,2,3],tensor:[1,2],test:5,text:[5,10],them:3,therefor:[3,10],thi:[0,2,3,10],three:11,time:2,tini:10,token:5,token_type_id:5,took:[2,10],torch:[1,3,5,10],torchvisiondatasetwrapp:10,tqdm:5,train:[1,2,3,4,5,6,10,13],train_it:5,trang:5,transfer:[0,2],transform:[4,6,10,13],truncat:5,tupl:[3,5,10,12],twice:6,two:[3,10,11],type:[3,4,5,6,10,12],typeerror:0,union:[0,3,4,12],updat:3,use:[0,2,11],used:4,useful:0,using:[2,3,10],usual:[0,2],util:[1,5,10,11],val_it:5,valid:[5,10,13],valid_metr:10,valu:[3,4],vector:2,version:6,vision:[11,12],w_1:10,w_2:10,w_3:10,wai:[0,2,11],want:0,weight:[4,5,10],when:0,which:[0,6],wide:6,wide_resnet101_2:6,wide_resnet50_2:6,within:3,without:4,wrap:0,wrapper:[1,2],wrp:10,yet:4,you:[0,2,11],your:[0,11],zero_grad:5},titles:["Callbacks","Data","Distillation","Loss functions","Runners","Huggingface transformers","Computer Vision","Pruning","&lt;no title&gt;","Quantization","Examples","Welcome to Compressors\u2019s documentation!","Models","Runners"],titleterms:{"function":3,callback:[0,7],complex:10,compressor:11,comput:6,data:1,differ:0,distil:2,document:11,exampl:10,hidden:0,huggingfac:5,idea:2,logit:0,loss:3,main:2,minim:10,model:12,nlp:10,philosophi:2,prune:7,quantiz:9,runner:[4,7,13],state:0,submodul:2,transform:5,util:7,vision:6,welcom:11,why:11,wrapper:0}})